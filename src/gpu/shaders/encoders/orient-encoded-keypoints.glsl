/*
 * speedy-vision.js
 * GPU-accelerated Computer Vision for the web
 * Copyright 2020 Alexandre Martins <alemartf(at)gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * orient-encoded-keypoints.glsl
 * Given an encoded keypoint texture, find the orientation of all keypoints
 */

@include "math.glsl"
@include "pyramids.glsl"
@include "orientation.glsl"

uniform sampler2D pyramid; // image pyramid (patch size depends on keypoint scale)
uniform int patchRadius; // use a circular patch of radius <= 7 (for lod = 0)
uniform sampler2D encodedKeypoints; // encoded keypoints
uniform int encoderLength;
uniform int descriptorSize;

// Circular patches around the origin
const int patchStart[8] = int[8](0, 0, 8, 28, 64, 132, 228, 356);
const int patchPointCount[8] = int[8](0, 8, 20, 36, 68, 96, 128, 168);
const ivec2 patchData[524] = ivec2[524](

    //
    // Circular patches with different radii
    // (hopefully) optimized for cache efficiency
    //

    // Patch of radius 1: 8 points starting at index 0
    ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(-1,0),ivec2(1,0),ivec2(-1,1),ivec2(0,1),ivec2(1,1),

    // Patch of radius 2: 20 points starting at index 8
    ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(-1,2),ivec2(0,2),ivec2(1,2),

    // Patch of radius 3: 36 points starting at index 28
    ivec2(-1,-3),ivec2(0,-3),ivec2(1,-3),ivec2(-2,-2),ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(2,-2),ivec2(-3,-1),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(3,-1),ivec2(-3,0),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(3,0),ivec2(-3,1),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(3,1),ivec2(-2,2),ivec2(-1,2),ivec2(0,2),ivec2(1,2),ivec2(2,2),ivec2(-1,3),ivec2(0,3),ivec2(1,3),

    // Patch of radius 4: 68 points starting at index 64
    ivec2(-2,-4),ivec2(-1,-4),ivec2(0,-4),ivec2(1,-4),ivec2(2,-4),ivec2(-3,-3),ivec2(-2,-3),ivec2(-1,-3),ivec2(0,-3),ivec2(1,-3),ivec2(2,-3),ivec2(3,-3),ivec2(-4,-2),ivec2(-3,-2),ivec2(-2,-2),ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(2,-2),ivec2(3,-2),ivec2(4,-2),ivec2(-4,-1),ivec2(-3,-1),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(3,-1),ivec2(4,-1),ivec2(-4,0),ivec2(-3,0),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(3,0),ivec2(4,0),ivec2(-4,1),ivec2(-3,1),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(3,1),ivec2(4,1),ivec2(-4,2),ivec2(-3,2),ivec2(-2,2),ivec2(-1,2),ivec2(0,2),ivec2(1,2),ivec2(2,2),ivec2(3,2),ivec2(4,2),ivec2(-3,3),ivec2(-2,3),ivec2(-1,3),ivec2(0,3),ivec2(1,3),ivec2(2,3),ivec2(3,3),ivec2(-2,4),ivec2(-1,4),ivec2(0,4),ivec2(1,4),ivec2(2,4),

    // Patch of radius 5: 96 points starting at index 132
    ivec2(-2,-5),ivec2(-1,-5),ivec2(0,-5),ivec2(1,-5),ivec2(2,-5),ivec2(-3,-4),ivec2(-2,-4),ivec2(-1,-4),ivec2(0,-4),ivec2(1,-4),ivec2(2,-4),ivec2(3,-4),ivec2(-4,-3),ivec2(-3,-3),ivec2(-2,-3),ivec2(-1,-3),ivec2(0,-3),ivec2(1,-3),ivec2(2,-3),ivec2(3,-3),ivec2(4,-3),ivec2(-5,-2),ivec2(-4,-2),ivec2(-3,-2),ivec2(-2,-2),ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(2,-2),ivec2(3,-2),ivec2(4,-2),ivec2(5,-2),ivec2(-5,-1),ivec2(-4,-1),ivec2(-3,-1),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(3,-1),ivec2(4,-1),ivec2(5,-1),ivec2(-5,0),ivec2(-4,0),ivec2(-3,0),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(3,0),ivec2(4,0),ivec2(5,0),ivec2(-5,1),ivec2(-4,1),ivec2(-3,1),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(3,1),ivec2(4,1),ivec2(5,1),ivec2(-5,2),ivec2(-4,2),ivec2(-3,2),ivec2(-2,2),ivec2(-1,2),ivec2(0,2),ivec2(1,2),ivec2(2,2),ivec2(3,2),ivec2(4,2),ivec2(5,2),ivec2(-4,3),ivec2(-3,3),ivec2(-2,3),ivec2(-1,3),ivec2(0,3),ivec2(1,3),ivec2(2,3),ivec2(3,3),ivec2(4,3),ivec2(-3,4),ivec2(-2,4),ivec2(-1,4),ivec2(0,4),ivec2(1,4),ivec2(2,4),ivec2(3,4),ivec2(-2,5),ivec2(-1,5),ivec2(0,5),ivec2(1,5),ivec2(2,5),

    // Patch of radius 6: 128 points starting at index 228
    ivec2(-2,-6),ivec2(-1,-6),ivec2(0,-6),ivec2(1,-6),ivec2(2,-6),ivec2(-3,-5),ivec2(-2,-5),ivec2(-1,-5),ivec2(0,-5),ivec2(1,-5),ivec2(2,-5),ivec2(3,-5),ivec2(-4,-4),ivec2(-3,-4),ivec2(-2,-4),ivec2(-1,-4),ivec2(0,-4),ivec2(1,-4),ivec2(2,-4),ivec2(3,-4),ivec2(4,-4),ivec2(-5,-3),ivec2(-4,-3),ivec2(-3,-3),ivec2(-2,-3),ivec2(-1,-3),ivec2(0,-3),ivec2(1,-3),ivec2(2,-3),ivec2(3,-3),ivec2(4,-3),ivec2(5,-3),ivec2(-6,-2),ivec2(-5,-2),ivec2(-4,-2),ivec2(-3,-2),ivec2(-2,-2),ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(2,-2),ivec2(3,-2),ivec2(4,-2),ivec2(5,-2),ivec2(6,-2),ivec2(-6,-1),ivec2(-5,-1),ivec2(-4,-1),ivec2(-3,-1),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(3,-1),ivec2(4,-1),ivec2(5,-1),ivec2(6,-1),ivec2(-6,0),ivec2(-5,0),ivec2(-4,0),ivec2(-3,0),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(3,0),ivec2(4,0),ivec2(5,0),ivec2(6,0),ivec2(-6,1),ivec2(-5,1),ivec2(-4,1),ivec2(-3,1),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(3,1),ivec2(4,1),ivec2(5,1),ivec2(6,1),ivec2(-6,2),ivec2(-5,2),ivec2(-4,2),ivec2(-3,2),ivec2(-2,2),ivec2(-1,2),ivec2(0,2),ivec2(1,2),ivec2(2,2),ivec2(3,2),ivec2(4,2),ivec2(5,2),ivec2(6,2),ivec2(-5,3),ivec2(-4,3),ivec2(-3,3),ivec2(-2,3),ivec2(-1,3),ivec2(0,3),ivec2(1,3),ivec2(2,3),ivec2(3,3),ivec2(4,3),ivec2(5,3),ivec2(-4,4),ivec2(-3,4),ivec2(-2,4),ivec2(-1,4),ivec2(0,4),ivec2(1,4),ivec2(2,4),ivec2(3,4),ivec2(4,4),ivec2(-3,5),ivec2(-2,5),ivec2(-1,5),ivec2(0,5),ivec2(1,5),ivec2(2,5),ivec2(3,5),ivec2(-2,6),ivec2(-1,6),ivec2(0,6),ivec2(1,6),ivec2(2,6),

    // Patch of radius 7: 168 points starting at index 356
    ivec2(-2,-7),ivec2(-1,-7),ivec2(0,-7),ivec2(1,-7),ivec2(2,-7),ivec2(-4,-6),ivec2(-3,-6),ivec2(-2,-6),ivec2(-1,-6),ivec2(0,-6),ivec2(1,-6),ivec2(2,-6),ivec2(3,-6),ivec2(4,-6),ivec2(-5,-5),ivec2(-3,-5),ivec2(-2,-5),ivec2(-1,-5),ivec2(0,-5),ivec2(1,-5),ivec2(2,-5),ivec2(3,-5),ivec2(5,-5),ivec2(-6,-4),ivec2(-4,-4),ivec2(-3,-4),ivec2(-2,-4),ivec2(-1,-4),ivec2(0,-4),ivec2(1,-4),ivec2(2,-4),ivec2(3,-4),ivec2(4,-4),ivec2(6,-4),ivec2(-6,-3),ivec2(-5,-3),ivec2(-4,-3),ivec2(-3,-3),ivec2(-2,-3),ivec2(-1,-3),ivec2(0,-3),ivec2(1,-3),ivec2(2,-3),ivec2(3,-3),ivec2(4,-3),ivec2(5,-3),ivec2(6,-3),ivec2(-7,-2),ivec2(-6,-2),ivec2(-5,-2),ivec2(-4,-2),ivec2(-3,-2),ivec2(-2,-2),ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(2,-2),ivec2(3,-2),ivec2(4,-2),ivec2(5,-2),ivec2(6,-2),ivec2(7,-2),ivec2(-7,-1),ivec2(-6,-1),ivec2(-5,-1),ivec2(-4,-1),ivec2(-3,-1),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(3,-1),ivec2(4,-1),ivec2(5,-1),ivec2(6,-1),ivec2(7,-1),ivec2(-7,0),ivec2(-6,0),ivec2(-5,0),ivec2(-4,0),ivec2(-3,0),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(3,0),ivec2(4,0),ivec2(5,0),ivec2(6,0),ivec2(7,0),ivec2(-7,1),ivec2(-6,1),ivec2(-5,1),ivec2(-4,1),ivec2(-3,1),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(3,1),ivec2(4,1),ivec2(5,1),ivec2(6,1),ivec2(7,1),ivec2(-7,2),ivec2(-6,2),ivec2(-5,2),ivec2(-4,2),ivec2(-3,2),ivec2(-2,2),ivec2(-1,2),ivec2(0,2),ivec2(1,2),ivec2(2,2),ivec2(3,2),ivec2(4,2),ivec2(5,2),ivec2(6,2),ivec2(7,2),ivec2(-6,3),ivec2(-5,3),ivec2(-4,3),ivec2(-3,3),ivec2(-2,3),ivec2(-1,3),ivec2(0,3),ivec2(1,3),ivec2(2,3),ivec2(3,3),ivec2(4,3),ivec2(5,3),ivec2(6,3),ivec2(-6,4),ivec2(-4,4),ivec2(-3,4),ivec2(-2,4),ivec2(-1,4),ivec2(0,4),ivec2(1,4),ivec2(2,4),ivec2(3,4),ivec2(4,4),ivec2(6,4),ivec2(-5,5),ivec2(-3,5),ivec2(-2,5),ivec2(-1,5),ivec2(0,5),ivec2(1,5),ivec2(2,5),ivec2(3,5),ivec2(5,5),ivec2(-4,6),ivec2(-3,6),ivec2(-2,6),ivec2(-1,6),ivec2(0,6),ivec2(1,6),ivec2(2,6),ivec2(3,6),ivec2(4,6),ivec2(-2,7),ivec2(-1,7),ivec2(0,7),ivec2(1,7),ivec2(2,7)

    // Do we really need radii larger than 7?
    // That's a lot of texture accesses!
/*,
    // Patch of radius 8: 212 points starting at index 524
    ivec2(-2,-8),ivec2(-1,-8),ivec2(0,-8),ivec2(1,-8),ivec2(2,-8),ivec2(-4,-7),ivec2(-3,-7),ivec2(-2,-7),ivec2(-1,-7),ivec2(0,-7),ivec2(1,-7),ivec2(2,-7),ivec2(3,-7),ivec2(4,-7),ivec2(-5,-6),ivec2(-4,-6),ivec2(-3,-6),ivec2(-2,-6),ivec2(-1,-6),ivec2(0,-6),ivec2(1,-6),ivec2(2,-6),ivec2(3,-6),ivec2(4,-6),ivec2(5,-6),ivec2(-6,-5),ivec2(-5,-5),ivec2(-3,-5),ivec2(-2,-5),ivec2(-1,-5),ivec2(0,-5),ivec2(1,-5),ivec2(2,-5),ivec2(3,-5),ivec2(5,-5),ivec2(6,-5),ivec2(-7,-4),ivec2(-6,-4),ivec2(-4,-4),ivec2(-3,-4),ivec2(-2,-4),ivec2(-1,-4),ivec2(0,-4),ivec2(1,-4),ivec2(2,-4),ivec2(3,-4),ivec2(4,-4),ivec2(6,-4),ivec2(7,-4),ivec2(-7,-3),ivec2(-6,-3),ivec2(-5,-3),ivec2(-4,-3),ivec2(-3,-3),ivec2(-2,-3),ivec2(-1,-3),ivec2(0,-3),ivec2(1,-3),ivec2(2,-3),ivec2(3,-3),ivec2(4,-3),ivec2(5,-3),ivec2(6,-3),ivec2(7,-3),ivec2(-8,-2),ivec2(-7,-2),ivec2(-6,-2),ivec2(-5,-2),ivec2(-4,-2),ivec2(-3,-2),ivec2(-2,-2),ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(2,-2),ivec2(3,-2),ivec2(4,-2),ivec2(5,-2),ivec2(6,-2),ivec2(7,-2),ivec2(8,-2),ivec2(-8,-1),ivec2(-7,-1),ivec2(-6,-1),ivec2(-5,-1),ivec2(-4,-1),ivec2(-3,-1),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(3,-1),ivec2(4,-1),ivec2(5,-1),ivec2(6,-1),ivec2(7,-1),ivec2(8,-1),ivec2(-8,0),ivec2(-7,0),ivec2(-6,0),ivec2(-5,0),ivec2(-4,0),ivec2(-3,0),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(3,0),ivec2(4,0),ivec2(5,0),ivec2(6,0),ivec2(7,0),ivec2(8,0),ivec2(-8,1),ivec2(-7,1),ivec2(-6,1),ivec2(-5,1),ivec2(-4,1),ivec2(-3,1),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(3,1),ivec2(4,1),ivec2(5,1),ivec2(6,1),ivec2(7,1),ivec2(8,1),ivec2(-8,2),ivec2(-7,2),ivec2(-6,2),ivec2(-5,2),ivec2(-4,2),ivec2(-3,2),ivec2(-2,2),ivec2(-1,2),ivec2(0,2),ivec2(1,2),ivec2(2,2),ivec2(3,2),ivec2(4,2),ivec2(5,2),ivec2(6,2),ivec2(7,2),ivec2(8,2),ivec2(-7,3),ivec2(-6,3),ivec2(-5,3),ivec2(-4,3),ivec2(-3,3),ivec2(-2,3),ivec2(-1,3),ivec2(0,3),ivec2(1,3),ivec2(2,3),ivec2(3,3),ivec2(4,3),ivec2(5,3),ivec2(6,3),ivec2(7,3),ivec2(-7,4),ivec2(-6,4),ivec2(-4,4),ivec2(-3,4),ivec2(-2,4),ivec2(-1,4),ivec2(0,4),ivec2(1,4),ivec2(2,4),ivec2(3,4),ivec2(4,4),ivec2(6,4),ivec2(7,4),ivec2(-6,5),ivec2(-5,5),ivec2(-3,5),ivec2(-2,5),ivec2(-1,5),ivec2(0,5),ivec2(1,5),ivec2(2,5),ivec2(3,5),ivec2(5,5),ivec2(6,5),ivec2(-5,6),ivec2(-4,6),ivec2(-3,6),ivec2(-2,6),ivec2(-1,6),ivec2(0,6),ivec2(1,6),ivec2(2,6),ivec2(3,6),ivec2(4,6),ivec2(5,6),ivec2(-4,7),ivec2(-3,7),ivec2(-2,7),ivec2(-1,7),ivec2(0,7),ivec2(1,7),ivec2(2,7),ivec2(3,7),ivec2(4,7),ivec2(-2,8),ivec2(-1,8),ivec2(0,8),ivec2(1,8),ivec2(2,8),

    // Patch of radius 9: 264 points starting at index 736
    ivec2(-2,-9),ivec2(-1,-9),ivec2(0,-9),ivec2(1,-9),ivec2(2,-9),ivec2(-4,-8),ivec2(-3,-8),ivec2(-2,-8),ivec2(-1,-8),ivec2(0,-8),ivec2(1,-8),ivec2(2,-8),ivec2(3,-8),ivec2(4,-8),ivec2(-6,-7),ivec2(-5,-7),ivec2(-4,-7),ivec2(-3,-7),ivec2(-2,-7),ivec2(-1,-7),ivec2(0,-7),ivec2(1,-7),ivec2(2,-7),ivec2(3,-7),ivec2(4,-7),ivec2(5,-7),ivec2(6,-7),ivec2(-7,-6),ivec2(-5,-6),ivec2(-4,-6),ivec2(-3,-6),ivec2(-2,-6),ivec2(-1,-6),ivec2(0,-6),ivec2(1,-6),ivec2(2,-6),ivec2(3,-6),ivec2(4,-6),ivec2(5,-6),ivec2(7,-6),ivec2(-7,-5),ivec2(-6,-5),ivec2(-5,-5),ivec2(-3,-5),ivec2(-2,-5),ivec2(-1,-5),ivec2(0,-5),ivec2(1,-5),ivec2(2,-5),ivec2(3,-5),ivec2(5,-5),ivec2(6,-5),ivec2(7,-5),ivec2(-8,-4),ivec2(-7,-4),ivec2(-6,-4),ivec2(-4,-4),ivec2(-3,-4),ivec2(-2,-4),ivec2(-1,-4),ivec2(0,-4),ivec2(1,-4),ivec2(2,-4),ivec2(3,-4),ivec2(4,-4),ivec2(6,-4),ivec2(7,-4),ivec2(8,-4),ivec2(-8,-3),ivec2(-7,-3),ivec2(-6,-3),ivec2(-5,-3),ivec2(-4,-3),ivec2(-3,-3),ivec2(-2,-3),ivec2(-1,-3),ivec2(0,-3),ivec2(1,-3),ivec2(2,-3),ivec2(3,-3),ivec2(4,-3),ivec2(5,-3),ivec2(6,-3),ivec2(7,-3),ivec2(8,-3),ivec2(-9,-2),ivec2(-8,-2),ivec2(-7,-2),ivec2(-6,-2),ivec2(-5,-2),ivec2(-4,-2),ivec2(-3,-2),ivec2(-2,-2),ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(2,-2),ivec2(3,-2),ivec2(4,-2),ivec2(5,-2),ivec2(6,-2),ivec2(7,-2),ivec2(8,-2),ivec2(9,-2),ivec2(-9,-1),ivec2(-8,-1),ivec2(-7,-1),ivec2(-6,-1),ivec2(-5,-1),ivec2(-4,-1),ivec2(-3,-1),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(3,-1),ivec2(4,-1),ivec2(5,-1),ivec2(6,-1),ivec2(7,-1),ivec2(8,-1),ivec2(9,-1),ivec2(-9,0),ivec2(-8,0),ivec2(-7,0),ivec2(-6,0),ivec2(-5,0),ivec2(-4,0),ivec2(-3,0),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(3,0),ivec2(4,0),ivec2(5,0),ivec2(6,0),ivec2(7,0),ivec2(8,0),ivec2(9,0),ivec2(-9,1),ivec2(-8,1),ivec2(-7,1),ivec2(-6,1),ivec2(-5,1),ivec2(-4,1),ivec2(-3,1),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(3,1),ivec2(4,1),ivec2(5,1),ivec2(6,1),ivec2(7,1),ivec2(8,1),ivec2(9,1),ivec2(-9,2),ivec2(-8,2),ivec2(-7,2),ivec2(-6,2),ivec2(-5,2),ivec2(-4,2),ivec2(-3,2),ivec2(-2,2),ivec2(-1,2),ivec2(0,2),ivec2(1,2),ivec2(2,2),ivec2(3,2),ivec2(4,2),ivec2(5,2),ivec2(6,2),ivec2(7,2),ivec2(8,2),ivec2(9,2),ivec2(-8,3),ivec2(-7,3),ivec2(-6,3),ivec2(-5,3),ivec2(-4,3),ivec2(-3,3),ivec2(-2,3),ivec2(-1,3),ivec2(0,3),ivec2(1,3),ivec2(2,3),ivec2(3,3),ivec2(4,3),ivec2(5,3),ivec2(6,3),ivec2(7,3),ivec2(8,3),ivec2(-8,4),ivec2(-7,4),ivec2(-6,4),ivec2(-4,4),ivec2(-3,4),ivec2(-2,4),ivec2(-1,4),ivec2(0,4),ivec2(1,4),ivec2(2,4),ivec2(3,4),ivec2(4,4),ivec2(6,4),ivec2(7,4),ivec2(8,4),ivec2(-7,5),ivec2(-6,5),ivec2(-5,5),ivec2(-3,5),ivec2(-2,5),ivec2(-1,5),ivec2(0,5),ivec2(1,5),ivec2(2,5),ivec2(3,5),ivec2(5,5),ivec2(6,5),ivec2(7,5),ivec2(-7,6),ivec2(-5,6),ivec2(-4,6),ivec2(-3,6),ivec2(-2,6),ivec2(-1,6),ivec2(0,6),ivec2(1,6),ivec2(2,6),ivec2(3,6),ivec2(4,6),ivec2(5,6),ivec2(7,6),ivec2(-6,7),ivec2(-5,7),ivec2(-4,7),ivec2(-3,7),ivec2(-2,7),ivec2(-1,7),ivec2(0,7),ivec2(1,7),ivec2(2,7),ivec2(3,7),ivec2(4,7),ivec2(5,7),ivec2(6,7),ivec2(-4,8),ivec2(-3,8),ivec2(-2,8),ivec2(-1,8),ivec2(0,8),ivec2(1,8),ivec2(2,8),ivec2(3,8),ivec2(4,8),ivec2(-2,9),ivec2(-1,9),ivec2(0,9),ivec2(1,9),ivec2(2,9),

    // Patch of radius 10: 320 points starting at index 1000
    ivec2(-3,-10),ivec2(-2,-10),ivec2(-1,-10),ivec2(0,-10),ivec2(1,-10),ivec2(2,-10),ivec2(3,-10),ivec2(-5,-9),ivec2(-4,-9),ivec2(-2,-9),ivec2(-1,-9),ivec2(0,-9),ivec2(1,-9),ivec2(2,-9),ivec2(4,-9),ivec2(5,-9),ivec2(-6,-8),ivec2(-4,-8),ivec2(-3,-8),ivec2(-2,-8),ivec2(-1,-8),ivec2(0,-8),ivec2(1,-8),ivec2(2,-8),ivec2(3,-8),ivec2(4,-8),ivec2(6,-8),ivec2(-7,-7),ivec2(-6,-7),ivec2(-5,-7),ivec2(-4,-7),ivec2(-3,-7),ivec2(-2,-7),ivec2(-1,-7),ivec2(0,-7),ivec2(1,-7),ivec2(2,-7),ivec2(3,-7),ivec2(4,-7),ivec2(5,-7),ivec2(6,-7),ivec2(7,-7),ivec2(-8,-6),ivec2(-7,-6),ivec2(-5,-6),ivec2(-4,-6),ivec2(-3,-6),ivec2(-2,-6),ivec2(-1,-6),ivec2(0,-6),ivec2(1,-6),ivec2(2,-6),ivec2(3,-6),ivec2(4,-6),ivec2(5,-6),ivec2(7,-6),ivec2(8,-6),ivec2(-9,-5),ivec2(-7,-5),ivec2(-6,-5),ivec2(-5,-5),ivec2(-3,-5),ivec2(-2,-5),ivec2(-1,-5),ivec2(0,-5),ivec2(1,-5),ivec2(2,-5),ivec2(3,-5),ivec2(5,-5),ivec2(6,-5),ivec2(7,-5),ivec2(9,-5),ivec2(-9,-4),ivec2(-8,-4),ivec2(-7,-4),ivec2(-6,-4),ivec2(-4,-4),ivec2(-3,-4),ivec2(-2,-4),ivec2(-1,-4),ivec2(0,-4),ivec2(1,-4),ivec2(2,-4),ivec2(3,-4),ivec2(4,-4),ivec2(6,-4),ivec2(7,-4),ivec2(8,-4),ivec2(9,-4),ivec2(-10,-3),ivec2(-8,-3),ivec2(-7,-3),ivec2(-6,-3),ivec2(-5,-3),ivec2(-4,-3),ivec2(-3,-3),ivec2(-2,-3),ivec2(-1,-3),ivec2(0,-3),ivec2(1,-3),ivec2(2,-3),ivec2(3,-3),ivec2(4,-3),ivec2(5,-3),ivec2(6,-3),ivec2(7,-3),ivec2(8,-3),ivec2(10,-3),ivec2(-10,-2),ivec2(-9,-2),ivec2(-8,-2),ivec2(-7,-2),ivec2(-6,-2),ivec2(-5,-2),ivec2(-4,-2),ivec2(-3,-2),ivec2(-2,-2),ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(2,-2),ivec2(3,-2),ivec2(4,-2),ivec2(5,-2),ivec2(6,-2),ivec2(7,-2),ivec2(8,-2),ivec2(9,-2),ivec2(10,-2),ivec2(-10,-1),ivec2(-9,-1),ivec2(-8,-1),ivec2(-7,-1),ivec2(-6,-1),ivec2(-5,-1),ivec2(-4,-1),ivec2(-3,-1),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(3,-1),ivec2(4,-1),ivec2(5,-1),ivec2(6,-1),ivec2(7,-1),ivec2(8,-1),ivec2(9,-1),ivec2(10,-1),ivec2(-10,0),ivec2(-9,0),ivec2(-8,0),ivec2(-7,0),ivec2(-6,0),ivec2(-5,0),ivec2(-4,0),ivec2(-3,0),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(3,0),ivec2(4,0),ivec2(5,0),ivec2(6,0),ivec2(7,0),ivec2(8,0),ivec2(9,0),ivec2(10,0),ivec2(-10,1),ivec2(-9,1),ivec2(-8,1),ivec2(-7,1),ivec2(-6,1),ivec2(-5,1),ivec2(-4,1),ivec2(-3,1),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(3,1),ivec2(4,1),ivec2(5,1),ivec2(6,1),ivec2(7,1),ivec2(8,1),ivec2(9,1),ivec2(10,1),ivec2(-10,2),ivec2(-9,2),ivec2(-8,2),ivec2(-7,2),ivec2(-6,2),ivec2(-5,2),ivec2(-4,2),ivec2(-3,2),ivec2(-2,2),ivec2(-1,2),ivec2(0,2),ivec2(1,2),ivec2(2,2),ivec2(3,2),ivec2(4,2),ivec2(5,2),ivec2(6,2),ivec2(7,2),ivec2(8,2),ivec2(9,2),ivec2(10,2),ivec2(-10,3),ivec2(-8,3),ivec2(-7,3),ivec2(-6,3),ivec2(-5,3),ivec2(-4,3),ivec2(-3,3),ivec2(-2,3),ivec2(-1,3),ivec2(0,3),ivec2(1,3),ivec2(2,3),ivec2(3,3),ivec2(4,3),ivec2(5,3),ivec2(6,3),ivec2(7,3),ivec2(8,3),ivec2(10,3),ivec2(-9,4),ivec2(-8,4),ivec2(-7,4),ivec2(-6,4),ivec2(-4,4),ivec2(-3,4),ivec2(-2,4),ivec2(-1,4),ivec2(0,4),ivec2(1,4),ivec2(2,4),ivec2(3,4),ivec2(4,4),ivec2(6,4),ivec2(7,4),ivec2(8,4),ivec2(9,4),ivec2(-9,5),ivec2(-7,5),ivec2(-6,5),ivec2(-5,5),ivec2(-3,5),ivec2(-2,5),ivec2(-1,5),ivec2(0,5),ivec2(1,5),ivec2(2,5),ivec2(3,5),ivec2(5,5),ivec2(6,5),ivec2(7,5),ivec2(9,5),ivec2(-8,6),ivec2(-7,6),ivec2(-5,6),ivec2(-4,6),ivec2(-3,6),ivec2(-2,6),ivec2(-1,6),ivec2(0,6),ivec2(1,6),ivec2(2,6),ivec2(3,6),ivec2(4,6),ivec2(5,6),ivec2(7,6),ivec2(8,6),ivec2(-7,7),ivec2(-6,7),ivec2(-5,7),ivec2(-4,7),ivec2(-3,7),ivec2(-2,7),ivec2(-1,7),ivec2(0,7),ivec2(1,7),ivec2(2,7),ivec2(3,7),ivec2(4,7),ivec2(5,7),ivec2(6,7),ivec2(7,7),ivec2(-6,8),ivec2(-4,8),ivec2(-3,8),ivec2(-2,8),ivec2(-1,8),ivec2(0,8),ivec2(1,8),ivec2(2,8),ivec2(3,8),ivec2(4,8),ivec2(6,8),ivec2(-5,9),ivec2(-4,9),ivec2(-2,9),ivec2(-1,9),ivec2(0,9),ivec2(1,9),ivec2(2,9),ivec2(4,9),ivec2(5,9),ivec2(-3,10),ivec2(-2,10),ivec2(-1,10),ivec2(0,10),ivec2(1,10),ivec2(2,10),ivec2(3,10),

    // Patch of radius 11: 392 points starting at index 1320
    ivec2(-3,-11),ivec2(-2,-11),ivec2(-1,-11),ivec2(0,-11),ivec2(1,-11),ivec2(2,-11),ivec2(3,-11),ivec2(-5,-10),ivec2(-4,-10),ivec2(-3,-10),ivec2(-2,-10),ivec2(-1,-10),ivec2(0,-10),ivec2(1,-10),ivec2(2,-10),ivec2(3,-10),ivec2(4,-10),ivec2(5,-10),ivec2(-7,-9),ivec2(-6,-9),ivec2(-5,-9),ivec2(-4,-9),ivec2(-2,-9),ivec2(-1,-9),ivec2(0,-9),ivec2(1,-9),ivec2(2,-9),ivec2(4,-9),ivec2(5,-9),ivec2(6,-9),ivec2(7,-9),ivec2(-8,-8),ivec2(-7,-8),ivec2(-6,-8),ivec2(-4,-8),ivec2(-3,-8),ivec2(-2,-8),ivec2(-1,-8),ivec2(0,-8),ivec2(1,-8),ivec2(2,-8),ivec2(3,-8),ivec2(4,-8),ivec2(6,-8),ivec2(7,-8),ivec2(8,-8),ivec2(-9,-7),ivec2(-8,-7),ivec2(-7,-7),ivec2(-6,-7),ivec2(-5,-7),ivec2(-4,-7),ivec2(-3,-7),ivec2(-2,-7),ivec2(-1,-7),ivec2(0,-7),ivec2(1,-7),ivec2(2,-7),ivec2(3,-7),ivec2(4,-7),ivec2(5,-7),ivec2(6,-7),ivec2(7,-7),ivec2(8,-7),ivec2(9,-7),ivec2(-9,-6),ivec2(-8,-6),ivec2(-7,-6),ivec2(-5,-6),ivec2(-4,-6),ivec2(-3,-6),ivec2(-2,-6),ivec2(-1,-6),ivec2(0,-6),ivec2(1,-6),ivec2(2,-6),ivec2(3,-6),ivec2(4,-6),ivec2(5,-6),ivec2(7,-6),ivec2(8,-6),ivec2(9,-6),ivec2(-10,-5),ivec2(-9,-5),ivec2(-7,-5),ivec2(-6,-5),ivec2(-5,-5),ivec2(-3,-5),ivec2(-2,-5),ivec2(-1,-5),ivec2(0,-5),ivec2(1,-5),ivec2(2,-5),ivec2(3,-5),ivec2(5,-5),ivec2(6,-5),ivec2(7,-5),ivec2(9,-5),ivec2(10,-5),ivec2(-10,-4),ivec2(-9,-4),ivec2(-8,-4),ivec2(-7,-4),ivec2(-6,-4),ivec2(-4,-4),ivec2(-3,-4),ivec2(-2,-4),ivec2(-1,-4),ivec2(0,-4),ivec2(1,-4),ivec2(2,-4),ivec2(3,-4),ivec2(4,-4),ivec2(6,-4),ivec2(7,-4),ivec2(8,-4),ivec2(9,-4),ivec2(10,-4),ivec2(-11,-3),ivec2(-10,-3),ivec2(-8,-3),ivec2(-7,-3),ivec2(-6,-3),ivec2(-5,-3),ivec2(-4,-3),ivec2(-3,-3),ivec2(-2,-3),ivec2(-1,-3),ivec2(0,-3),ivec2(1,-3),ivec2(2,-3),ivec2(3,-3),ivec2(4,-3),ivec2(5,-3),ivec2(6,-3),ivec2(7,-3),ivec2(8,-3),ivec2(10,-3),ivec2(11,-3),ivec2(-11,-2),ivec2(-10,-2),ivec2(-9,-2),ivec2(-8,-2),ivec2(-7,-2),ivec2(-6,-2),ivec2(-5,-2),ivec2(-4,-2),ivec2(-3,-2),ivec2(-2,-2),ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(2,-2),ivec2(3,-2),ivec2(4,-2),ivec2(5,-2),ivec2(6,-2),ivec2(7,-2),ivec2(8,-2),ivec2(9,-2),ivec2(10,-2),ivec2(11,-2),ivec2(-11,-1),ivec2(-10,-1),ivec2(-9,-1),ivec2(-8,-1),ivec2(-7,-1),ivec2(-6,-1),ivec2(-5,-1),ivec2(-4,-1),ivec2(-3,-1),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(3,-1),ivec2(4,-1),ivec2(5,-1),ivec2(6,-1),ivec2(7,-1),ivec2(8,-1),ivec2(9,-1),ivec2(10,-1),ivec2(11,-1),ivec2(-11,0),ivec2(-10,0),ivec2(-9,0),ivec2(-8,0),ivec2(-7,0),ivec2(-6,0),ivec2(-5,0),ivec2(-4,0),ivec2(-3,0),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(3,0),ivec2(4,0),ivec2(5,0),ivec2(6,0),ivec2(7,0),ivec2(8,0),ivec2(9,0),ivec2(10,0),ivec2(11,0),ivec2(-11,1),ivec2(-10,1),ivec2(-9,1),ivec2(-8,1),ivec2(-7,1),ivec2(-6,1),ivec2(-5,1),ivec2(-4,1),ivec2(-3,1),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(3,1),ivec2(4,1),ivec2(5,1),ivec2(6,1),ivec2(7,1),ivec2(8,1),ivec2(9,1),ivec2(10,1),ivec2(11,1),ivec2(-11,2),ivec2(-10,2),ivec2(-9,2),ivec2(-8,2),ivec2(-7,2),ivec2(-6,2),ivec2(-5,2),ivec2(-4,2),ivec2(-3,2),ivec2(-2,2),ivec2(-1,2),ivec2(0,2),ivec2(1,2),ivec2(2,2),ivec2(3,2),ivec2(4,2),ivec2(5,2),ivec2(6,2),ivec2(7,2),ivec2(8,2),ivec2(9,2),ivec2(10,2),ivec2(11,2),ivec2(-11,3),ivec2(-10,3),ivec2(-8,3),ivec2(-7,3),ivec2(-6,3),ivec2(-5,3),ivec2(-4,3),ivec2(-3,3),ivec2(-2,3),ivec2(-1,3),ivec2(0,3),ivec2(1,3),ivec2(2,3),ivec2(3,3),ivec2(4,3),ivec2(5,3),ivec2(6,3),ivec2(7,3),ivec2(8,3),ivec2(10,3),ivec2(11,3),ivec2(-10,4),ivec2(-9,4),ivec2(-8,4),ivec2(-7,4),ivec2(-6,4),ivec2(-4,4),ivec2(-3,4),ivec2(-2,4),ivec2(-1,4),ivec2(0,4),ivec2(1,4),ivec2(2,4),ivec2(3,4),ivec2(4,4),ivec2(6,4),ivec2(7,4),ivec2(8,4),ivec2(9,4),ivec2(10,4),ivec2(-10,5),ivec2(-9,5),ivec2(-7,5),ivec2(-6,5),ivec2(-5,5),ivec2(-3,5),ivec2(-2,5),ivec2(-1,5),ivec2(0,5),ivec2(1,5),ivec2(2,5),ivec2(3,5),ivec2(5,5),ivec2(6,5),ivec2(7,5),ivec2(9,5),ivec2(10,5),ivec2(-9,6),ivec2(-8,6),ivec2(-7,6),ivec2(-5,6),ivec2(-4,6),ivec2(-3,6),ivec2(-2,6),ivec2(-1,6),ivec2(0,6),ivec2(1,6),ivec2(2,6),ivec2(3,6),ivec2(4,6),ivec2(5,6),ivec2(7,6),ivec2(8,6),ivec2(9,6),ivec2(-9,7),ivec2(-8,7),ivec2(-7,7),ivec2(-6,7),ivec2(-5,7),ivec2(-4,7),ivec2(-3,7),ivec2(-2,7),ivec2(-1,7),ivec2(0,7),ivec2(1,7),ivec2(2,7),ivec2(3,7),ivec2(4,7),ivec2(5,7),ivec2(6,7),ivec2(7,7),ivec2(8,7),ivec2(9,7),ivec2(-8,8),ivec2(-7,8),ivec2(-6,8),ivec2(-4,8),ivec2(-3,8),ivec2(-2,8),ivec2(-1,8),ivec2(0,8),ivec2(1,8),ivec2(2,8),ivec2(3,8),ivec2(4,8),ivec2(6,8),ivec2(7,8),ivec2(8,8),ivec2(-7,9),ivec2(-6,9),ivec2(-5,9),ivec2(-4,9),ivec2(-2,9),ivec2(-1,9),ivec2(0,9),ivec2(1,9),ivec2(2,9),ivec2(4,9),ivec2(5,9),ivec2(6,9),ivec2(7,9),ivec2(-5,10),ivec2(-4,10),ivec2(-3,10),ivec2(-2,10),ivec2(-1,10),ivec2(0,10),ivec2(1,10),ivec2(2,10),ivec2(3,10),ivec2(4,10),ivec2(5,10),ivec2(-3,11),ivec2(-2,11),ivec2(-1,11),ivec2(0,11),ivec2(1,11),ivec2(2,11),ivec2(3,11),

    // Patch of radius 12: 460 points starting at index 1712
    ivec2(-3,-12),ivec2(-2,-12),ivec2(-1,-12),ivec2(0,-12),ivec2(1,-12),ivec2(2,-12),ivec2(3,-12),ivec2(-5,-11),ivec2(-4,-11),ivec2(-3,-11),ivec2(-2,-11),ivec2(-1,-11),ivec2(0,-11),ivec2(1,-11),ivec2(2,-11),ivec2(3,-11),ivec2(4,-11),ivec2(5,-11),ivec2(-7,-10),ivec2(-6,-10),ivec2(-5,-10),ivec2(-4,-10),ivec2(-3,-10),ivec2(-2,-10),ivec2(-1,-10),ivec2(0,-10),ivec2(1,-10),ivec2(2,-10),ivec2(3,-10),ivec2(4,-10),ivec2(5,-10),ivec2(6,-10),ivec2(7,-10),ivec2(-8,-9),ivec2(-7,-9),ivec2(-6,-9),ivec2(-5,-9),ivec2(-4,-9),ivec2(-2,-9),ivec2(-1,-9),ivec2(0,-9),ivec2(1,-9),ivec2(2,-9),ivec2(4,-9),ivec2(5,-9),ivec2(6,-9),ivec2(7,-9),ivec2(8,-9),ivec2(-9,-8),ivec2(-8,-8),ivec2(-7,-8),ivec2(-6,-8),ivec2(-4,-8),ivec2(-3,-8),ivec2(-2,-8),ivec2(-1,-8),ivec2(0,-8),ivec2(1,-8),ivec2(2,-8),ivec2(3,-8),ivec2(4,-8),ivec2(6,-8),ivec2(7,-8),ivec2(8,-8),ivec2(9,-8),ivec2(-10,-7),ivec2(-9,-7),ivec2(-8,-7),ivec2(-7,-7),ivec2(-6,-7),ivec2(-5,-7),ivec2(-4,-7),ivec2(-3,-7),ivec2(-2,-7),ivec2(-1,-7),ivec2(0,-7),ivec2(1,-7),ivec2(2,-7),ivec2(3,-7),ivec2(4,-7),ivec2(5,-7),ivec2(6,-7),ivec2(7,-7),ivec2(8,-7),ivec2(9,-7),ivec2(10,-7),ivec2(-10,-6),ivec2(-9,-6),ivec2(-8,-6),ivec2(-7,-6),ivec2(-5,-6),ivec2(-4,-6),ivec2(-3,-6),ivec2(-2,-6),ivec2(-1,-6),ivec2(0,-6),ivec2(1,-6),ivec2(2,-6),ivec2(3,-6),ivec2(4,-6),ivec2(5,-6),ivec2(7,-6),ivec2(8,-6),ivec2(9,-6),ivec2(10,-6),ivec2(-11,-5),ivec2(-10,-5),ivec2(-9,-5),ivec2(-7,-5),ivec2(-6,-5),ivec2(-5,-5),ivec2(-3,-5),ivec2(-2,-5),ivec2(-1,-5),ivec2(0,-5),ivec2(1,-5),ivec2(2,-5),ivec2(3,-5),ivec2(5,-5),ivec2(6,-5),ivec2(7,-5),ivec2(9,-5),ivec2(10,-5),ivec2(11,-5),ivec2(-11,-4),ivec2(-10,-4),ivec2(-9,-4),ivec2(-8,-4),ivec2(-7,-4),ivec2(-6,-4),ivec2(-4,-4),ivec2(-3,-4),ivec2(-2,-4),ivec2(-1,-4),ivec2(0,-4),ivec2(1,-4),ivec2(2,-4),ivec2(3,-4),ivec2(4,-4),ivec2(6,-4),ivec2(7,-4),ivec2(8,-4),ivec2(9,-4),ivec2(10,-4),ivec2(11,-4),ivec2(-12,-3),ivec2(-11,-3),ivec2(-10,-3),ivec2(-8,-3),ivec2(-7,-3),ivec2(-6,-3),ivec2(-5,-3),ivec2(-4,-3),ivec2(-3,-3),ivec2(-2,-3),ivec2(-1,-3),ivec2(0,-3),ivec2(1,-3),ivec2(2,-3),ivec2(3,-3),ivec2(4,-3),ivec2(5,-3),ivec2(6,-3),ivec2(7,-3),ivec2(8,-3),ivec2(10,-3),ivec2(11,-3),ivec2(12,-3),ivec2(-12,-2),ivec2(-11,-2),ivec2(-10,-2),ivec2(-9,-2),ivec2(-8,-2),ivec2(-7,-2),ivec2(-6,-2),ivec2(-5,-2),ivec2(-4,-2),ivec2(-3,-2),ivec2(-2,-2),ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(2,-2),ivec2(3,-2),ivec2(4,-2),ivec2(5,-2),ivec2(6,-2),ivec2(7,-2),ivec2(8,-2),ivec2(9,-2),ivec2(10,-2),ivec2(11,-2),ivec2(12,-2),ivec2(-12,-1),ivec2(-11,-1),ivec2(-10,-1),ivec2(-9,-1),ivec2(-8,-1),ivec2(-7,-1),ivec2(-6,-1),ivec2(-5,-1),ivec2(-4,-1),ivec2(-3,-1),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(3,-1),ivec2(4,-1),ivec2(5,-1),ivec2(6,-1),ivec2(7,-1),ivec2(8,-1),ivec2(9,-1),ivec2(10,-1),ivec2(11,-1),ivec2(12,-1),ivec2(-12,0),ivec2(-11,0),ivec2(-10,0),ivec2(-9,0),ivec2(-8,0),ivec2(-7,0),ivec2(-6,0),ivec2(-5,0),ivec2(-4,0),ivec2(-3,0),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(3,0),ivec2(4,0),ivec2(5,0),ivec2(6,0),ivec2(7,0),ivec2(8,0),ivec2(9,0),ivec2(10,0),ivec2(11,0),ivec2(12,0),ivec2(-12,1),ivec2(-11,1),ivec2(-10,1),ivec2(-9,1),ivec2(-8,1),ivec2(-7,1),ivec2(-6,1),ivec2(-5,1),ivec2(-4,1),ivec2(-3,1),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(3,1),ivec2(4,1),ivec2(5,1),ivec2(6,1),ivec2(7,1),ivec2(8,1),ivec2(9,1),ivec2(10,1),ivec2(11,1),ivec2(12,1),ivec2(-12,2),ivec2(-11,2),ivec2(-10,2),ivec2(-9,2),ivec2(-8,2),ivec2(-7,2),ivec2(-6,2),ivec2(-5,2),ivec2(-4,2),ivec2(-3,2),ivec2(-2,2),ivec2(-1,2),ivec2(0,2),ivec2(1,2),ivec2(2,2),ivec2(3,2),ivec2(4,2),ivec2(5,2),ivec2(6,2),ivec2(7,2),ivec2(8,2),ivec2(9,2),ivec2(10,2),ivec2(11,2),ivec2(12,2),ivec2(-12,3),ivec2(-11,3),ivec2(-10,3),ivec2(-8,3),ivec2(-7,3),ivec2(-6,3),ivec2(-5,3),ivec2(-4,3),ivec2(-3,3),ivec2(-2,3),ivec2(-1,3),ivec2(0,3),ivec2(1,3),ivec2(2,3),ivec2(3,3),ivec2(4,3),ivec2(5,3),ivec2(6,3),ivec2(7,3),ivec2(8,3),ivec2(10,3),ivec2(11,3),ivec2(12,3),ivec2(-11,4),ivec2(-10,4),ivec2(-9,4),ivec2(-8,4),ivec2(-7,4),ivec2(-6,4),ivec2(-4,4),ivec2(-3,4),ivec2(-2,4),ivec2(-1,4),ivec2(0,4),ivec2(1,4),ivec2(2,4),ivec2(3,4),ivec2(4,4),ivec2(6,4),ivec2(7,4),ivec2(8,4),ivec2(9,4),ivec2(10,4),ivec2(11,4),ivec2(-11,5),ivec2(-10,5),ivec2(-9,5),ivec2(-7,5),ivec2(-6,5),ivec2(-5,5),ivec2(-3,5),ivec2(-2,5),ivec2(-1,5),ivec2(0,5),ivec2(1,5),ivec2(2,5),ivec2(3,5),ivec2(5,5),ivec2(6,5),ivec2(7,5),ivec2(9,5),ivec2(10,5),ivec2(11,5),ivec2(-10,6),ivec2(-9,6),ivec2(-8,6),ivec2(-7,6),ivec2(-5,6),ivec2(-4,6),ivec2(-3,6),ivec2(-2,6),ivec2(-1,6),ivec2(0,6),ivec2(1,6),ivec2(2,6),ivec2(3,6),ivec2(4,6),ivec2(5,6),ivec2(7,6),ivec2(8,6),ivec2(9,6),ivec2(10,6),ivec2(-10,7),ivec2(-9,7),ivec2(-8,7),ivec2(-7,7),ivec2(-6,7),ivec2(-5,7),ivec2(-4,7),ivec2(-3,7),ivec2(-2,7),ivec2(-1,7),ivec2(0,7),ivec2(1,7),ivec2(2,7),ivec2(3,7),ivec2(4,7),ivec2(5,7),ivec2(6,7),ivec2(7,7),ivec2(8,7),ivec2(9,7),ivec2(10,7),ivec2(-9,8),ivec2(-8,8),ivec2(-7,8),ivec2(-6,8),ivec2(-4,8),ivec2(-3,8),ivec2(-2,8),ivec2(-1,8),ivec2(0,8),ivec2(1,8),ivec2(2,8),ivec2(3,8),ivec2(4,8),ivec2(6,8),ivec2(7,8),ivec2(8,8),ivec2(9,8),ivec2(-8,9),ivec2(-7,9),ivec2(-6,9),ivec2(-5,9),ivec2(-4,9),ivec2(-2,9),ivec2(-1,9),ivec2(0,9),ivec2(1,9),ivec2(2,9),ivec2(4,9),ivec2(5,9),ivec2(6,9),ivec2(7,9),ivec2(8,9),ivec2(-7,10),ivec2(-6,10),ivec2(-5,10),ivec2(-4,10),ivec2(-3,10),ivec2(-2,10),ivec2(-1,10),ivec2(0,10),ivec2(1,10),ivec2(2,10),ivec2(3,10),ivec2(4,10),ivec2(5,10),ivec2(6,10),ivec2(7,10),ivec2(-5,11),ivec2(-4,11),ivec2(-3,11),ivec2(-2,11),ivec2(-1,11),ivec2(0,11),ivec2(1,11),ivec2(2,11),ivec2(3,11),ivec2(4,11),ivec2(5,11),ivec2(-3,12),ivec2(-2,12),ivec2(-1,12),ivec2(0,12),ivec2(1,12),ivec2(2,12),ivec2(3,12),

    // Patch of radius 13: 532 points starting at index 2172
    ivec2(-3,-13),ivec2(-2,-13),ivec2(-1,-13),ivec2(0,-13),ivec2(1,-13),ivec2(2,-13),ivec2(3,-13),ivec2(-6,-12),ivec2(-5,-12),ivec2(-4,-12),ivec2(-3,-12),ivec2(-2,-12),ivec2(-1,-12),ivec2(0,-12),ivec2(1,-12),ivec2(2,-12),ivec2(3,-12),ivec2(4,-12),ivec2(5,-12),ivec2(6,-12),ivec2(-7,-11),ivec2(-5,-11),ivec2(-4,-11),ivec2(-3,-11),ivec2(-2,-11),ivec2(-1,-11),ivec2(0,-11),ivec2(1,-11),ivec2(2,-11),ivec2(3,-11),ivec2(4,-11),ivec2(5,-11),ivec2(7,-11),ivec2(-8,-10),ivec2(-7,-10),ivec2(-6,-10),ivec2(-5,-10),ivec2(-4,-10),ivec2(-3,-10),ivec2(-2,-10),ivec2(-1,-10),ivec2(0,-10),ivec2(1,-10),ivec2(2,-10),ivec2(3,-10),ivec2(4,-10),ivec2(5,-10),ivec2(6,-10),ivec2(7,-10),ivec2(8,-10),ivec2(-9,-9),ivec2(-8,-9),ivec2(-7,-9),ivec2(-6,-9),ivec2(-5,-9),ivec2(-4,-9),ivec2(-2,-9),ivec2(-1,-9),ivec2(0,-9),ivec2(1,-9),ivec2(2,-9),ivec2(4,-9),ivec2(5,-9),ivec2(6,-9),ivec2(7,-9),ivec2(8,-9),ivec2(9,-9),ivec2(-10,-8),ivec2(-9,-8),ivec2(-8,-8),ivec2(-7,-8),ivec2(-6,-8),ivec2(-4,-8),ivec2(-3,-8),ivec2(-2,-8),ivec2(-1,-8),ivec2(0,-8),ivec2(1,-8),ivec2(2,-8),ivec2(3,-8),ivec2(4,-8),ivec2(6,-8),ivec2(7,-8),ivec2(8,-8),ivec2(9,-8),ivec2(10,-8),ivec2(-11,-7),ivec2(-10,-7),ivec2(-9,-7),ivec2(-8,-7),ivec2(-7,-7),ivec2(-6,-7),ivec2(-5,-7),ivec2(-4,-7),ivec2(-3,-7),ivec2(-2,-7),ivec2(-1,-7),ivec2(0,-7),ivec2(1,-7),ivec2(2,-7),ivec2(3,-7),ivec2(4,-7),ivec2(5,-7),ivec2(6,-7),ivec2(7,-7),ivec2(8,-7),ivec2(9,-7),ivec2(10,-7),ivec2(11,-7),ivec2(-12,-6),ivec2(-10,-6),ivec2(-9,-6),ivec2(-8,-6),ivec2(-7,-6),ivec2(-5,-6),ivec2(-4,-6),ivec2(-3,-6),ivec2(-2,-6),ivec2(-1,-6),ivec2(0,-6),ivec2(1,-6),ivec2(2,-6),ivec2(3,-6),ivec2(4,-6),ivec2(5,-6),ivec2(7,-6),ivec2(8,-6),ivec2(9,-6),ivec2(10,-6),ivec2(12,-6),ivec2(-12,-5),ivec2(-11,-5),ivec2(-10,-5),ivec2(-9,-5),ivec2(-7,-5),ivec2(-6,-5),ivec2(-5,-5),ivec2(-3,-5),ivec2(-2,-5),ivec2(-1,-5),ivec2(0,-5),ivec2(1,-5),ivec2(2,-5),ivec2(3,-5),ivec2(5,-5),ivec2(6,-5),ivec2(7,-5),ivec2(9,-5),ivec2(10,-5),ivec2(11,-5),ivec2(12,-5),ivec2(-12,-4),ivec2(-11,-4),ivec2(-10,-4),ivec2(-9,-4),ivec2(-8,-4),ivec2(-7,-4),ivec2(-6,-4),ivec2(-4,-4),ivec2(-3,-4),ivec2(-2,-4),ivec2(-1,-4),ivec2(0,-4),ivec2(1,-4),ivec2(2,-4),ivec2(3,-4),ivec2(4,-4),ivec2(6,-4),ivec2(7,-4),ivec2(8,-4),ivec2(9,-4),ivec2(10,-4),ivec2(11,-4),ivec2(12,-4),ivec2(-13,-3),ivec2(-12,-3),ivec2(-11,-3),ivec2(-10,-3),ivec2(-8,-3),ivec2(-7,-3),ivec2(-6,-3),ivec2(-5,-3),ivec2(-4,-3),ivec2(-3,-3),ivec2(-2,-3),ivec2(-1,-3),ivec2(0,-3),ivec2(1,-3),ivec2(2,-3),ivec2(3,-3),ivec2(4,-3),ivec2(5,-3),ivec2(6,-3),ivec2(7,-3),ivec2(8,-3),ivec2(10,-3),ivec2(11,-3),ivec2(12,-3),ivec2(13,-3),ivec2(-13,-2),ivec2(-12,-2),ivec2(-11,-2),ivec2(-10,-2),ivec2(-9,-2),ivec2(-8,-2),ivec2(-7,-2),ivec2(-6,-2),ivec2(-5,-2),ivec2(-4,-2),ivec2(-3,-2),ivec2(-2,-2),ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(2,-2),ivec2(3,-2),ivec2(4,-2),ivec2(5,-2),ivec2(6,-2),ivec2(7,-2),ivec2(8,-2),ivec2(9,-2),ivec2(10,-2),ivec2(11,-2),ivec2(12,-2),ivec2(13,-2),ivec2(-13,-1),ivec2(-12,-1),ivec2(-11,-1),ivec2(-10,-1),ivec2(-9,-1),ivec2(-8,-1),ivec2(-7,-1),ivec2(-6,-1),ivec2(-5,-1),ivec2(-4,-1),ivec2(-3,-1),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(3,-1),ivec2(4,-1),ivec2(5,-1),ivec2(6,-1),ivec2(7,-1),ivec2(8,-1),ivec2(9,-1),ivec2(10,-1),ivec2(11,-1),ivec2(12,-1),ivec2(13,-1),ivec2(-13,0),ivec2(-12,0),ivec2(-11,0),ivec2(-10,0),ivec2(-9,0),ivec2(-8,0),ivec2(-7,0),ivec2(-6,0),ivec2(-5,0),ivec2(-4,0),ivec2(-3,0),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(3,0),ivec2(4,0),ivec2(5,0),ivec2(6,0),ivec2(7,0),ivec2(8,0),ivec2(9,0),ivec2(10,0),ivec2(11,0),ivec2(12,0),ivec2(13,0),ivec2(-13,1),ivec2(-12,1),ivec2(-11,1),ivec2(-10,1),ivec2(-9,1),ivec2(-8,1),ivec2(-7,1),ivec2(-6,1),ivec2(-5,1),ivec2(-4,1),ivec2(-3,1),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(3,1),ivec2(4,1),ivec2(5,1),ivec2(6,1),ivec2(7,1),ivec2(8,1),ivec2(9,1),ivec2(10,1),ivec2(11,1),ivec2(12,1),ivec2(13,1),ivec2(-13,2),ivec2(-12,2),ivec2(-11,2),ivec2(-10,2),ivec2(-9,2),ivec2(-8,2),ivec2(-7,2),ivec2(-6,2),ivec2(-5,2),ivec2(-4,2),ivec2(-3,2),ivec2(-2,2),ivec2(-1,2),ivec2(0,2),ivec2(1,2),ivec2(2,2),ivec2(3,2),ivec2(4,2),ivec2(5,2),ivec2(6,2),ivec2(7,2),ivec2(8,2),ivec2(9,2),ivec2(10,2),ivec2(11,2),ivec2(12,2),ivec2(13,2),ivec2(-13,3),ivec2(-12,3),ivec2(-11,3),ivec2(-10,3),ivec2(-8,3),ivec2(-7,3),ivec2(-6,3),ivec2(-5,3),ivec2(-4,3),ivec2(-3,3),ivec2(-2,3),ivec2(-1,3),ivec2(0,3),ivec2(1,3),ivec2(2,3),ivec2(3,3),ivec2(4,3),ivec2(5,3),ivec2(6,3),ivec2(7,3),ivec2(8,3),ivec2(10,3),ivec2(11,3),ivec2(12,3),ivec2(13,3),ivec2(-12,4),ivec2(-11,4),ivec2(-10,4),ivec2(-9,4),ivec2(-8,4),ivec2(-7,4),ivec2(-6,4),ivec2(-4,4),ivec2(-3,4),ivec2(-2,4),ivec2(-1,4),ivec2(0,4),ivec2(1,4),ivec2(2,4),ivec2(3,4),ivec2(4,4),ivec2(6,4),ivec2(7,4),ivec2(8,4),ivec2(9,4),ivec2(10,4),ivec2(11,4),ivec2(12,4),ivec2(-12,5),ivec2(-11,5),ivec2(-10,5),ivec2(-9,5),ivec2(-7,5),ivec2(-6,5),ivec2(-5,5),ivec2(-3,5),ivec2(-2,5),ivec2(-1,5),ivec2(0,5),ivec2(1,5),ivec2(2,5),ivec2(3,5),ivec2(5,5),ivec2(6,5),ivec2(7,5),ivec2(9,5),ivec2(10,5),ivec2(11,5),ivec2(12,5),ivec2(-12,6),ivec2(-10,6),ivec2(-9,6),ivec2(-8,6),ivec2(-7,6),ivec2(-5,6),ivec2(-4,6),ivec2(-3,6),ivec2(-2,6),ivec2(-1,6),ivec2(0,6),ivec2(1,6),ivec2(2,6),ivec2(3,6),ivec2(4,6),ivec2(5,6),ivec2(7,6),ivec2(8,6),ivec2(9,6),ivec2(10,6),ivec2(12,6),ivec2(-11,7),ivec2(-10,7),ivec2(-9,7),ivec2(-8,7),ivec2(-7,7),ivec2(-6,7),ivec2(-5,7),ivec2(-4,7),ivec2(-3,7),ivec2(-2,7),ivec2(-1,7),ivec2(0,7),ivec2(1,7),ivec2(2,7),ivec2(3,7),ivec2(4,7),ivec2(5,7),ivec2(6,7),ivec2(7,7),ivec2(8,7),ivec2(9,7),ivec2(10,7),ivec2(11,7),ivec2(-10,8),ivec2(-9,8),ivec2(-8,8),ivec2(-7,8),ivec2(-6,8),ivec2(-4,8),ivec2(-3,8),ivec2(-2,8),ivec2(-1,8),ivec2(0,8),ivec2(1,8),ivec2(2,8),ivec2(3,8),ivec2(4,8),ivec2(6,8),ivec2(7,8),ivec2(8,8),ivec2(9,8),ivec2(10,8),ivec2(-9,9),ivec2(-8,9),ivec2(-7,9),ivec2(-6,9),ivec2(-5,9),ivec2(-4,9),ivec2(-2,9),ivec2(-1,9),ivec2(0,9),ivec2(1,9),ivec2(2,9),ivec2(4,9),ivec2(5,9),ivec2(6,9),ivec2(7,9),ivec2(8,9),ivec2(9,9),ivec2(-8,10),ivec2(-7,10),ivec2(-6,10),ivec2(-5,10),ivec2(-4,10),ivec2(-3,10),ivec2(-2,10),ivec2(-1,10),ivec2(0,10),ivec2(1,10),ivec2(2,10),ivec2(3,10),ivec2(4,10),ivec2(5,10),ivec2(6,10),ivec2(7,10),ivec2(8,10),ivec2(-7,11),ivec2(-5,11),ivec2(-4,11),ivec2(-3,11),ivec2(-2,11),ivec2(-1,11),ivec2(0,11),ivec2(1,11),ivec2(2,11),ivec2(3,11),ivec2(4,11),ivec2(5,11),ivec2(7,11),ivec2(-6,12),ivec2(-5,12),ivec2(-4,12),ivec2(-3,12),ivec2(-2,12),ivec2(-1,12),ivec2(0,12),ivec2(1,12),ivec2(2,12),ivec2(3,12),ivec2(4,12),ivec2(5,12),ivec2(6,12),ivec2(-3,13),ivec2(-2,13),ivec2(-1,13),ivec2(0,13),ivec2(1,13),ivec2(2,13),ivec2(3,13),

    // Patch of radius 14: 612 points starting at index 2704
    ivec2(-3,-14),ivec2(-2,-14),ivec2(-1,-14),ivec2(0,-14),ivec2(1,-14),ivec2(2,-14),ivec2(3,-14),ivec2(-6,-13),ivec2(-5,-13),ivec2(-4,-13),ivec2(-3,-13),ivec2(-2,-13),ivec2(-1,-13),ivec2(0,-13),ivec2(1,-13),ivec2(2,-13),ivec2(3,-13),ivec2(4,-13),ivec2(5,-13),ivec2(6,-13),ivec2(-7,-12),ivec2(-6,-12),ivec2(-5,-12),ivec2(-4,-12),ivec2(-3,-12),ivec2(-2,-12),ivec2(-1,-12),ivec2(0,-12),ivec2(1,-12),ivec2(2,-12),ivec2(3,-12),ivec2(4,-12),ivec2(5,-12),ivec2(6,-12),ivec2(7,-12),ivec2(-9,-11),ivec2(-8,-11),ivec2(-7,-11),ivec2(-5,-11),ivec2(-4,-11),ivec2(-3,-11),ivec2(-2,-11),ivec2(-1,-11),ivec2(0,-11),ivec2(1,-11),ivec2(2,-11),ivec2(3,-11),ivec2(4,-11),ivec2(5,-11),ivec2(7,-11),ivec2(8,-11),ivec2(9,-11),ivec2(-10,-10),ivec2(-8,-10),ivec2(-7,-10),ivec2(-6,-10),ivec2(-5,-10),ivec2(-4,-10),ivec2(-3,-10),ivec2(-2,-10),ivec2(-1,-10),ivec2(0,-10),ivec2(1,-10),ivec2(2,-10),ivec2(3,-10),ivec2(4,-10),ivec2(5,-10),ivec2(6,-10),ivec2(7,-10),ivec2(8,-10),ivec2(10,-10),ivec2(-11,-9),ivec2(-9,-9),ivec2(-8,-9),ivec2(-7,-9),ivec2(-6,-9),ivec2(-5,-9),ivec2(-4,-9),ivec2(-2,-9),ivec2(-1,-9),ivec2(0,-9),ivec2(1,-9),ivec2(2,-9),ivec2(4,-9),ivec2(5,-9),ivec2(6,-9),ivec2(7,-9),ivec2(8,-9),ivec2(9,-9),ivec2(11,-9),ivec2(-11,-8),ivec2(-10,-8),ivec2(-9,-8),ivec2(-8,-8),ivec2(-7,-8),ivec2(-6,-8),ivec2(-4,-8),ivec2(-3,-8),ivec2(-2,-8),ivec2(-1,-8),ivec2(0,-8),ivec2(1,-8),ivec2(2,-8),ivec2(3,-8),ivec2(4,-8),ivec2(6,-8),ivec2(7,-8),ivec2(8,-8),ivec2(9,-8),ivec2(10,-8),ivec2(11,-8),ivec2(-12,-7),ivec2(-11,-7),ivec2(-10,-7),ivec2(-9,-7),ivec2(-8,-7),ivec2(-7,-7),ivec2(-6,-7),ivec2(-5,-7),ivec2(-4,-7),ivec2(-3,-7),ivec2(-2,-7),ivec2(-1,-7),ivec2(0,-7),ivec2(1,-7),ivec2(2,-7),ivec2(3,-7),ivec2(4,-7),ivec2(5,-7),ivec2(6,-7),ivec2(7,-7),ivec2(8,-7),ivec2(9,-7),ivec2(10,-7),ivec2(11,-7),ivec2(12,-7),ivec2(-13,-6),ivec2(-12,-6),ivec2(-10,-6),ivec2(-9,-6),ivec2(-8,-6),ivec2(-7,-6),ivec2(-5,-6),ivec2(-4,-6),ivec2(-3,-6),ivec2(-2,-6),ivec2(-1,-6),ivec2(0,-6),ivec2(1,-6),ivec2(2,-6),ivec2(3,-6),ivec2(4,-6),ivec2(5,-6),ivec2(7,-6),ivec2(8,-6),ivec2(9,-6),ivec2(10,-6),ivec2(12,-6),ivec2(13,-6),ivec2(-13,-5),ivec2(-12,-5),ivec2(-11,-5),ivec2(-10,-5),ivec2(-9,-5),ivec2(-7,-5),ivec2(-6,-5),ivec2(-5,-5),ivec2(-3,-5),ivec2(-2,-5),ivec2(-1,-5),ivec2(0,-5),ivec2(1,-5),ivec2(2,-5),ivec2(3,-5),ivec2(5,-5),ivec2(6,-5),ivec2(7,-5),ivec2(9,-5),ivec2(10,-5),ivec2(11,-5),ivec2(12,-5),ivec2(13,-5),ivec2(-13,-4),ivec2(-12,-4),ivec2(-11,-4),ivec2(-10,-4),ivec2(-9,-4),ivec2(-8,-4),ivec2(-7,-4),ivec2(-6,-4),ivec2(-4,-4),ivec2(-3,-4),ivec2(-2,-4),ivec2(-1,-4),ivec2(0,-4),ivec2(1,-4),ivec2(2,-4),ivec2(3,-4),ivec2(4,-4),ivec2(6,-4),ivec2(7,-4),ivec2(8,-4),ivec2(9,-4),ivec2(10,-4),ivec2(11,-4),ivec2(12,-4),ivec2(13,-4),ivec2(-14,-3),ivec2(-13,-3),ivec2(-12,-3),ivec2(-11,-3),ivec2(-10,-3),ivec2(-8,-3),ivec2(-7,-3),ivec2(-6,-3),ivec2(-5,-3),ivec2(-4,-3),ivec2(-3,-3),ivec2(-2,-3),ivec2(-1,-3),ivec2(0,-3),ivec2(1,-3),ivec2(2,-3),ivec2(3,-3),ivec2(4,-3),ivec2(5,-3),ivec2(6,-3),ivec2(7,-3),ivec2(8,-3),ivec2(10,-3),ivec2(11,-3),ivec2(12,-3),ivec2(13,-3),ivec2(14,-3),ivec2(-14,-2),ivec2(-13,-2),ivec2(-12,-2),ivec2(-11,-2),ivec2(-10,-2),ivec2(-9,-2),ivec2(-8,-2),ivec2(-7,-2),ivec2(-6,-2),ivec2(-5,-2),ivec2(-4,-2),ivec2(-3,-2),ivec2(-2,-2),ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(2,-2),ivec2(3,-2),ivec2(4,-2),ivec2(5,-2),ivec2(6,-2),ivec2(7,-2),ivec2(8,-2),ivec2(9,-2),ivec2(10,-2),ivec2(11,-2),ivec2(12,-2),ivec2(13,-2),ivec2(14,-2),ivec2(-14,-1),ivec2(-13,-1),ivec2(-12,-1),ivec2(-11,-1),ivec2(-10,-1),ivec2(-9,-1),ivec2(-8,-1),ivec2(-7,-1),ivec2(-6,-1),ivec2(-5,-1),ivec2(-4,-1),ivec2(-3,-1),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(3,-1),ivec2(4,-1),ivec2(5,-1),ivec2(6,-1),ivec2(7,-1),ivec2(8,-1),ivec2(9,-1),ivec2(10,-1),ivec2(11,-1),ivec2(12,-1),ivec2(13,-1),ivec2(14,-1),ivec2(-14,0),ivec2(-13,0),ivec2(-12,0),ivec2(-11,0),ivec2(-10,0),ivec2(-9,0),ivec2(-8,0),ivec2(-7,0),ivec2(-6,0),ivec2(-5,0),ivec2(-4,0),ivec2(-3,0),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(3,0),ivec2(4,0),ivec2(5,0),ivec2(6,0),ivec2(7,0),ivec2(8,0),ivec2(9,0),ivec2(10,0),ivec2(11,0),ivec2(12,0),ivec2(13,0),ivec2(14,0),ivec2(-14,1),ivec2(-13,1),ivec2(-12,1),ivec2(-11,1),ivec2(-10,1),ivec2(-9,1),ivec2(-8,1),ivec2(-7,1),ivec2(-6,1),ivec2(-5,1),ivec2(-4,1),ivec2(-3,1),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(3,1),ivec2(4,1),ivec2(5,1),ivec2(6,1),ivec2(7,1),ivec2(8,1),ivec2(9,1),ivec2(10,1),ivec2(11,1),ivec2(12,1),ivec2(13,1),ivec2(14,1),ivec2(-14,2),ivec2(-13,2),ivec2(-12,2),ivec2(-11,2),ivec2(-10,2),ivec2(-9,2),ivec2(-8,2),ivec2(-7,2),ivec2(-6,2),ivec2(-5,2),ivec2(-4,2),ivec2(-3,2),ivec2(-2,2),ivec2(-1,2),ivec2(0,2),ivec2(1,2),ivec2(2,2),ivec2(3,2),ivec2(4,2),ivec2(5,2),ivec2(6,2),ivec2(7,2),ivec2(8,2),ivec2(9,2),ivec2(10,2),ivec2(11,2),ivec2(12,2),ivec2(13,2),ivec2(14,2),ivec2(-14,3),ivec2(-13,3),ivec2(-12,3),ivec2(-11,3),ivec2(-10,3),ivec2(-8,3),ivec2(-7,3),ivec2(-6,3),ivec2(-5,3),ivec2(-4,3),ivec2(-3,3),ivec2(-2,3),ivec2(-1,3),ivec2(0,3),ivec2(1,3),ivec2(2,3),ivec2(3,3),ivec2(4,3),ivec2(5,3),ivec2(6,3),ivec2(7,3),ivec2(8,3),ivec2(10,3),ivec2(11,3),ivec2(12,3),ivec2(13,3),ivec2(14,3),ivec2(-13,4),ivec2(-12,4),ivec2(-11,4),ivec2(-10,4),ivec2(-9,4),ivec2(-8,4),ivec2(-7,4),ivec2(-6,4),ivec2(-4,4),ivec2(-3,4),ivec2(-2,4),ivec2(-1,4),ivec2(0,4),ivec2(1,4),ivec2(2,4),ivec2(3,4),ivec2(4,4),ivec2(6,4),ivec2(7,4),ivec2(8,4),ivec2(9,4),ivec2(10,4),ivec2(11,4),ivec2(12,4),ivec2(13,4),ivec2(-13,5),ivec2(-12,5),ivec2(-11,5),ivec2(-10,5),ivec2(-9,5),ivec2(-7,5),ivec2(-6,5),ivec2(-5,5),ivec2(-3,5),ivec2(-2,5),ivec2(-1,5),ivec2(0,5),ivec2(1,5),ivec2(2,5),ivec2(3,5),ivec2(5,5),ivec2(6,5),ivec2(7,5),ivec2(9,5),ivec2(10,5),ivec2(11,5),ivec2(12,5),ivec2(13,5),ivec2(-13,6),ivec2(-12,6),ivec2(-10,6),ivec2(-9,6),ivec2(-8,6),ivec2(-7,6),ivec2(-5,6),ivec2(-4,6),ivec2(-3,6),ivec2(-2,6),ivec2(-1,6),ivec2(0,6),ivec2(1,6),ivec2(2,6),ivec2(3,6),ivec2(4,6),ivec2(5,6),ivec2(7,6),ivec2(8,6),ivec2(9,6),ivec2(10,6),ivec2(12,6),ivec2(13,6),ivec2(-12,7),ivec2(-11,7),ivec2(-10,7),ivec2(-9,7),ivec2(-8,7),ivec2(-7,7),ivec2(-6,7),ivec2(-5,7),ivec2(-4,7),ivec2(-3,7),ivec2(-2,7),ivec2(-1,7),ivec2(0,7),ivec2(1,7),ivec2(2,7),ivec2(3,7),ivec2(4,7),ivec2(5,7),ivec2(6,7),ivec2(7,7),ivec2(8,7),ivec2(9,7),ivec2(10,7),ivec2(11,7),ivec2(12,7),ivec2(-11,8),ivec2(-10,8),ivec2(-9,8),ivec2(-8,8),ivec2(-7,8),ivec2(-6,8),ivec2(-4,8),ivec2(-3,8),ivec2(-2,8),ivec2(-1,8),ivec2(0,8),ivec2(1,8),ivec2(2,8),ivec2(3,8),ivec2(4,8),ivec2(6,8),ivec2(7,8),ivec2(8,8),ivec2(9,8),ivec2(10,8),ivec2(11,8),ivec2(-11,9),ivec2(-9,9),ivec2(-8,9),ivec2(-7,9),ivec2(-6,9),ivec2(-5,9),ivec2(-4,9),ivec2(-2,9),ivec2(-1,9),ivec2(0,9),ivec2(1,9),ivec2(2,9),ivec2(4,9),ivec2(5,9),ivec2(6,9),ivec2(7,9),ivec2(8,9),ivec2(9,9),ivec2(11,9),ivec2(-10,10),ivec2(-8,10),ivec2(-7,10),ivec2(-6,10),ivec2(-5,10),ivec2(-4,10),ivec2(-3,10),ivec2(-2,10),ivec2(-1,10),ivec2(0,10),ivec2(1,10),ivec2(2,10),ivec2(3,10),ivec2(4,10),ivec2(5,10),ivec2(6,10),ivec2(7,10),ivec2(8,10),ivec2(10,10),ivec2(-9,11),ivec2(-8,11),ivec2(-7,11),ivec2(-5,11),ivec2(-4,11),ivec2(-3,11),ivec2(-2,11),ivec2(-1,11),ivec2(0,11),ivec2(1,11),ivec2(2,11),ivec2(3,11),ivec2(4,11),ivec2(5,11),ivec2(7,11),ivec2(8,11),ivec2(9,11),ivec2(-7,12),ivec2(-6,12),ivec2(-5,12),ivec2(-4,12),ivec2(-3,12),ivec2(-2,12),ivec2(-1,12),ivec2(0,12),ivec2(1,12),ivec2(2,12),ivec2(3,12),ivec2(4,12),ivec2(5,12),ivec2(6,12),ivec2(7,12),ivec2(-6,13),ivec2(-5,13),ivec2(-4,13),ivec2(-3,13),ivec2(-2,13),ivec2(-1,13),ivec2(0,13),ivec2(1,13),ivec2(2,13),ivec2(3,13),ivec2(4,13),ivec2(5,13),ivec2(6,13),ivec2(-3,14),ivec2(-2,14),ivec2(-1,14),ivec2(0,14),ivec2(1,14),ivec2(2,14),ivec2(3,14),

    // Patch of radius 15: 696 points starting at index 3316
    ivec2(-3,-15),ivec2(-2,-15),ivec2(-1,-15),ivec2(0,-15),ivec2(1,-15),ivec2(2,-15),ivec2(3,-15),ivec2(-6,-14),ivec2(-5,-14),ivec2(-4,-14),ivec2(-3,-14),ivec2(-2,-14),ivec2(-1,-14),ivec2(0,-14),ivec2(1,-14),ivec2(2,-14),ivec2(3,-14),ivec2(4,-14),ivec2(5,-14),ivec2(6,-14),ivec2(-8,-13),ivec2(-7,-13),ivec2(-6,-13),ivec2(-5,-13),ivec2(-4,-13),ivec2(-3,-13),ivec2(-2,-13),ivec2(-1,-13),ivec2(0,-13),ivec2(1,-13),ivec2(2,-13),ivec2(3,-13),ivec2(4,-13),ivec2(5,-13),ivec2(6,-13),ivec2(7,-13),ivec2(8,-13),ivec2(-9,-12),ivec2(-7,-12),ivec2(-6,-12),ivec2(-5,-12),ivec2(-4,-12),ivec2(-3,-12),ivec2(-2,-12),ivec2(-1,-12),ivec2(0,-12),ivec2(1,-12),ivec2(2,-12),ivec2(3,-12),ivec2(4,-12),ivec2(5,-12),ivec2(6,-12),ivec2(7,-12),ivec2(9,-12),ivec2(-10,-11),ivec2(-9,-11),ivec2(-8,-11),ivec2(-7,-11),ivec2(-5,-11),ivec2(-4,-11),ivec2(-3,-11),ivec2(-2,-11),ivec2(-1,-11),ivec2(0,-11),ivec2(1,-11),ivec2(2,-11),ivec2(3,-11),ivec2(4,-11),ivec2(5,-11),ivec2(7,-11),ivec2(8,-11),ivec2(9,-11),ivec2(10,-11),ivec2(-11,-10),ivec2(-10,-10),ivec2(-8,-10),ivec2(-7,-10),ivec2(-6,-10),ivec2(-5,-10),ivec2(-4,-10),ivec2(-3,-10),ivec2(-2,-10),ivec2(-1,-10),ivec2(0,-10),ivec2(1,-10),ivec2(2,-10),ivec2(3,-10),ivec2(4,-10),ivec2(5,-10),ivec2(6,-10),ivec2(7,-10),ivec2(8,-10),ivec2(10,-10),ivec2(11,-10),ivec2(-12,-9),ivec2(-11,-9),ivec2(-9,-9),ivec2(-8,-9),ivec2(-7,-9),ivec2(-6,-9),ivec2(-5,-9),ivec2(-4,-9),ivec2(-2,-9),ivec2(-1,-9),ivec2(0,-9),ivec2(1,-9),ivec2(2,-9),ivec2(4,-9),ivec2(5,-9),ivec2(6,-9),ivec2(7,-9),ivec2(8,-9),ivec2(9,-9),ivec2(11,-9),ivec2(12,-9),ivec2(-13,-8),ivec2(-11,-8),ivec2(-10,-8),ivec2(-9,-8),ivec2(-8,-8),ivec2(-7,-8),ivec2(-6,-8),ivec2(-4,-8),ivec2(-3,-8),ivec2(-2,-8),ivec2(-1,-8),ivec2(0,-8),ivec2(1,-8),ivec2(2,-8),ivec2(3,-8),ivec2(4,-8),ivec2(6,-8),ivec2(7,-8),ivec2(8,-8),ivec2(9,-8),ivec2(10,-8),ivec2(11,-8),ivec2(13,-8),ivec2(-13,-7),ivec2(-12,-7),ivec2(-11,-7),ivec2(-10,-7),ivec2(-9,-7),ivec2(-8,-7),ivec2(-7,-7),ivec2(-6,-7),ivec2(-5,-7),ivec2(-4,-7),ivec2(-3,-7),ivec2(-2,-7),ivec2(-1,-7),ivec2(0,-7),ivec2(1,-7),ivec2(2,-7),ivec2(3,-7),ivec2(4,-7),ivec2(5,-7),ivec2(6,-7),ivec2(7,-7),ivec2(8,-7),ivec2(9,-7),ivec2(10,-7),ivec2(11,-7),ivec2(12,-7),ivec2(13,-7),ivec2(-14,-6),ivec2(-13,-6),ivec2(-12,-6),ivec2(-10,-6),ivec2(-9,-6),ivec2(-8,-6),ivec2(-7,-6),ivec2(-5,-6),ivec2(-4,-6),ivec2(-3,-6),ivec2(-2,-6),ivec2(-1,-6),ivec2(0,-6),ivec2(1,-6),ivec2(2,-6),ivec2(3,-6),ivec2(4,-6),ivec2(5,-6),ivec2(7,-6),ivec2(8,-6),ivec2(9,-6),ivec2(10,-6),ivec2(12,-6),ivec2(13,-6),ivec2(14,-6),ivec2(-14,-5),ivec2(-13,-5),ivec2(-12,-5),ivec2(-11,-5),ivec2(-10,-5),ivec2(-9,-5),ivec2(-7,-5),ivec2(-6,-5),ivec2(-5,-5),ivec2(-3,-5),ivec2(-2,-5),ivec2(-1,-5),ivec2(0,-5),ivec2(1,-5),ivec2(2,-5),ivec2(3,-5),ivec2(5,-5),ivec2(6,-5),ivec2(7,-5),ivec2(9,-5),ivec2(10,-5),ivec2(11,-5),ivec2(12,-5),ivec2(13,-5),ivec2(14,-5),ivec2(-14,-4),ivec2(-13,-4),ivec2(-12,-4),ivec2(-11,-4),ivec2(-10,-4),ivec2(-9,-4),ivec2(-8,-4),ivec2(-7,-4),ivec2(-6,-4),ivec2(-4,-4),ivec2(-3,-4),ivec2(-2,-4),ivec2(-1,-4),ivec2(0,-4),ivec2(1,-4),ivec2(2,-4),ivec2(3,-4),ivec2(4,-4),ivec2(6,-4),ivec2(7,-4),ivec2(8,-4),ivec2(9,-4),ivec2(10,-4),ivec2(11,-4),ivec2(12,-4),ivec2(13,-4),ivec2(14,-4),ivec2(-15,-3),ivec2(-14,-3),ivec2(-13,-3),ivec2(-12,-3),ivec2(-11,-3),ivec2(-10,-3),ivec2(-8,-3),ivec2(-7,-3),ivec2(-6,-3),ivec2(-5,-3),ivec2(-4,-3),ivec2(-3,-3),ivec2(-2,-3),ivec2(-1,-3),ivec2(0,-3),ivec2(1,-3),ivec2(2,-3),ivec2(3,-3),ivec2(4,-3),ivec2(5,-3),ivec2(6,-3),ivec2(7,-3),ivec2(8,-3),ivec2(10,-3),ivec2(11,-3),ivec2(12,-3),ivec2(13,-3),ivec2(14,-3),ivec2(15,-3),ivec2(-15,-2),ivec2(-14,-2),ivec2(-13,-2),ivec2(-12,-2),ivec2(-11,-2),ivec2(-10,-2),ivec2(-9,-2),ivec2(-8,-2),ivec2(-7,-2),ivec2(-6,-2),ivec2(-5,-2),ivec2(-4,-2),ivec2(-3,-2),ivec2(-2,-2),ivec2(-1,-2),ivec2(0,-2),ivec2(1,-2),ivec2(2,-2),ivec2(3,-2),ivec2(4,-2),ivec2(5,-2),ivec2(6,-2),ivec2(7,-2),ivec2(8,-2),ivec2(9,-2),ivec2(10,-2),ivec2(11,-2),ivec2(12,-2),ivec2(13,-2),ivec2(14,-2),ivec2(15,-2),ivec2(-15,-1),ivec2(-14,-1),ivec2(-13,-1),ivec2(-12,-1),ivec2(-11,-1),ivec2(-10,-1),ivec2(-9,-1),ivec2(-8,-1),ivec2(-7,-1),ivec2(-6,-1),ivec2(-5,-1),ivec2(-4,-1),ivec2(-3,-1),ivec2(-2,-1),ivec2(-1,-1),ivec2(0,-1),ivec2(1,-1),ivec2(2,-1),ivec2(3,-1),ivec2(4,-1),ivec2(5,-1),ivec2(6,-1),ivec2(7,-1),ivec2(8,-1),ivec2(9,-1),ivec2(10,-1),ivec2(11,-1),ivec2(12,-1),ivec2(13,-1),ivec2(14,-1),ivec2(15,-1),ivec2(-15,0),ivec2(-14,0),ivec2(-13,0),ivec2(-12,0),ivec2(-11,0),ivec2(-10,0),ivec2(-9,0),ivec2(-8,0),ivec2(-7,0),ivec2(-6,0),ivec2(-5,0),ivec2(-4,0),ivec2(-3,0),ivec2(-2,0),ivec2(-1,0),ivec2(1,0),ivec2(2,0),ivec2(3,0),ivec2(4,0),ivec2(5,0),ivec2(6,0),ivec2(7,0),ivec2(8,0),ivec2(9,0),ivec2(10,0),ivec2(11,0),ivec2(12,0),ivec2(13,0),ivec2(14,0),ivec2(15,0),ivec2(-15,1),ivec2(-14,1),ivec2(-13,1),ivec2(-12,1),ivec2(-11,1),ivec2(-10,1),ivec2(-9,1),ivec2(-8,1),ivec2(-7,1),ivec2(-6,1),ivec2(-5,1),ivec2(-4,1),ivec2(-3,1),ivec2(-2,1),ivec2(-1,1),ivec2(0,1),ivec2(1,1),ivec2(2,1),ivec2(3,1),ivec2(4,1),ivec2(5,1),ivec2(6,1),ivec2(7,1),ivec2(8,1),ivec2(9,1),ivec2(10,1),ivec2(11,1),ivec2(12,1),ivec2(13,1),ivec2(14,1),ivec2(15,1),ivec2(-15,2),ivec2(-14,2),ivec2(-13,2),ivec2(-12,2),ivec2(-11,2),ivec2(-10,2),ivec2(-9,2),ivec2(-8,2),ivec2(-7,2),ivec2(-6,2),ivec2(-5,2),ivec2(-4,2),ivec2(-3,2),ivec2(-2,2),ivec2(-1,2),ivec2(0,2),ivec2(1,2),ivec2(2,2),ivec2(3,2),ivec2(4,2),ivec2(5,2),ivec2(6,2),ivec2(7,2),ivec2(8,2),ivec2(9,2),ivec2(10,2),ivec2(11,2),ivec2(12,2),ivec2(13,2),ivec2(14,2),ivec2(15,2),ivec2(-15,3),ivec2(-14,3),ivec2(-13,3),ivec2(-12,3),ivec2(-11,3),ivec2(-10,3),ivec2(-8,3),ivec2(-7,3),ivec2(-6,3),ivec2(-5,3),ivec2(-4,3),ivec2(-3,3),ivec2(-2,3),ivec2(-1,3),ivec2(0,3),ivec2(1,3),ivec2(2,3),ivec2(3,3),ivec2(4,3),ivec2(5,3),ivec2(6,3),ivec2(7,3),ivec2(8,3),ivec2(10,3),ivec2(11,3),ivec2(12,3),ivec2(13,3),ivec2(14,3),ivec2(15,3),ivec2(-14,4),ivec2(-13,4),ivec2(-12,4),ivec2(-11,4),ivec2(-10,4),ivec2(-9,4),ivec2(-8,4),ivec2(-7,4),ivec2(-6,4),ivec2(-4,4),ivec2(-3,4),ivec2(-2,4),ivec2(-1,4),ivec2(0,4),ivec2(1,4),ivec2(2,4),ivec2(3,4),ivec2(4,4),ivec2(6,4),ivec2(7,4),ivec2(8,4),ivec2(9,4),ivec2(10,4),ivec2(11,4),ivec2(12,4),ivec2(13,4),ivec2(14,4),ivec2(-14,5),ivec2(-13,5),ivec2(-12,5),ivec2(-11,5),ivec2(-10,5),ivec2(-9,5),ivec2(-7,5),ivec2(-6,5),ivec2(-5,5),ivec2(-3,5),ivec2(-2,5),ivec2(-1,5),ivec2(0,5),ivec2(1,5),ivec2(2,5),ivec2(3,5),ivec2(5,5),ivec2(6,5),ivec2(7,5),ivec2(9,5),ivec2(10,5),ivec2(11,5),ivec2(12,5),ivec2(13,5),ivec2(14,5),ivec2(-14,6),ivec2(-13,6),ivec2(-12,6),ivec2(-10,6),ivec2(-9,6),ivec2(-8,6),ivec2(-7,6),ivec2(-5,6),ivec2(-4,6),ivec2(-3,6),ivec2(-2,6),ivec2(-1,6),ivec2(0,6),ivec2(1,6),ivec2(2,6),ivec2(3,6),ivec2(4,6),ivec2(5,6),ivec2(7,6),ivec2(8,6),ivec2(9,6),ivec2(10,6),ivec2(12,6),ivec2(13,6),ivec2(14,6),ivec2(-13,7),ivec2(-12,7),ivec2(-11,7),ivec2(-10,7),ivec2(-9,7),ivec2(-8,7),ivec2(-7,7),ivec2(-6,7),ivec2(-5,7),ivec2(-4,7),ivec2(-3,7),ivec2(-2,7),ivec2(-1,7),ivec2(0,7),ivec2(1,7),ivec2(2,7),ivec2(3,7),ivec2(4,7),ivec2(5,7),ivec2(6,7),ivec2(7,7),ivec2(8,7),ivec2(9,7),ivec2(10,7),ivec2(11,7),ivec2(12,7),ivec2(13,7),ivec2(-13,8),ivec2(-11,8),ivec2(-10,8),ivec2(-9,8),ivec2(-8,8),ivec2(-7,8),ivec2(-6,8),ivec2(-4,8),ivec2(-3,8),ivec2(-2,8),ivec2(-1,8),ivec2(0,8),ivec2(1,8),ivec2(2,8),ivec2(3,8),ivec2(4,8),ivec2(6,8),ivec2(7,8),ivec2(8,8),ivec2(9,8),ivec2(10,8),ivec2(11,8),ivec2(13,8),ivec2(-12,9),ivec2(-11,9),ivec2(-9,9),ivec2(-8,9),ivec2(-7,9),ivec2(-6,9),ivec2(-5,9),ivec2(-4,9),ivec2(-2,9),ivec2(-1,9),ivec2(0,9),ivec2(1,9),ivec2(2,9),ivec2(4,9),ivec2(5,9),ivec2(6,9),ivec2(7,9),ivec2(8,9),ivec2(9,9),ivec2(11,9),ivec2(12,9),ivec2(-11,10),ivec2(-10,10),ivec2(-8,10),ivec2(-7,10),ivec2(-6,10),ivec2(-5,10),ivec2(-4,10),ivec2(-3,10),ivec2(-2,10),ivec2(-1,10),ivec2(0,10),ivec2(1,10),ivec2(2,10),ivec2(3,10),ivec2(4,10),ivec2(5,10),ivec2(6,10),ivec2(7,10),ivec2(8,10),ivec2(10,10),ivec2(11,10),ivec2(-10,11),ivec2(-9,11),ivec2(-8,11),ivec2(-7,11),ivec2(-5,11),ivec2(-4,11),ivec2(-3,11),ivec2(-2,11),ivec2(-1,11),ivec2(0,11),ivec2(1,11),ivec2(2,11),ivec2(3,11),ivec2(4,11),ivec2(5,11),ivec2(7,11),ivec2(8,11),ivec2(9,11),ivec2(10,11),ivec2(-9,12),ivec2(-7,12),ivec2(-6,12),ivec2(-5,12),ivec2(-4,12),ivec2(-3,12),ivec2(-2,12),ivec2(-1,12),ivec2(0,12),ivec2(1,12),ivec2(2,12),ivec2(3,12),ivec2(4,12),ivec2(5,12),ivec2(6,12),ivec2(7,12),ivec2(9,12),ivec2(-8,13),ivec2(-7,13),ivec2(-6,13),ivec2(-5,13),ivec2(-4,13),ivec2(-3,13),ivec2(-2,13),ivec2(-1,13),ivec2(0,13),ivec2(1,13),ivec2(2,13),ivec2(3,13),ivec2(4,13),ivec2(5,13),ivec2(6,13),ivec2(7,13),ivec2(8,13),ivec2(-6,14),ivec2(-5,14),ivec2(-4,14),ivec2(-3,14),ivec2(-2,14),ivec2(-1,14),ivec2(0,14),ivec2(1,14),ivec2(2,14),ivec2(3,14),ivec2(4,14),ivec2(5,14),ivec2(6,14),ivec2(-3,15),ivec2(-2,15),ivec2(-1,15),ivec2(0,15),ivec2(1,15),ivec2(2,15),ivec2(3,15)

    // Number of points: 4012
*/
);

// Bounds
const int MIN_PATCH_RADIUS = 2; // tiny radii generate unstable angles
const int MAX_PATCH_RADIUS = 7; // we go up to this radius

void main()
{
    vec4 pixel = threadPixel(encodedKeypoints);
    ivec2 thread = threadLocation();
    int threadRaster = thread.y * encoderLength + thread.x;
    int pixelsPerKeypoint = 2 + descriptorSize / 4;
    int keypointId = int(threadRaster / pixelsPerKeypoint);
    int keypointCell = threadRaster % pixelsPerKeypoint;

    // not the keypoint properties cell?
    color = pixel;
    if(keypointCell != 1)
        return;

    // get keypoint position
    int positionCell = keypointId * pixelsPerKeypoint;
    ivec2 positionCellPos = ivec2(positionCell % encoderLength, positionCell / encoderLength);
    ivec4 encodedPosition = ivec4(texelFetch(encodedKeypoints, positionCellPos, 0) * 255.0f);
    ivec2 keypointPosition = ivec2(
        encodedPosition.r | (encodedPosition.g << 8),
        encodedPosition.b | (encodedPosition.a << 8)
    );

    // get keypoint scale
    float lod = decodeLod(pixel.r);
    float pot = exp2(lod);

    // read circular patch
    vec2 m = vec2(0.0f); // (m10, m01) image moments
    ivec2 pyrBaseSize = textureSize(pyramid, 0);
    int scaledRadius = int(ceil(float(patchRadius) / pot));
    int radius = clamp(scaledRadius, MIN_PATCH_RADIUS, MAX_PATCH_RADIUS);
    int start = patchStart[radius];
    int count = patchPointCount[radius];
    for(int j = 0; j < count; j++) {
        vec2 offset = vec2(patchData[start + j]);
        ivec2 position = keypointPosition + ivec2(round(pot * offset));
        vec4 patchPixel = pyrPixelAtEx(pyramid, position, lod, pyrBaseSize);
        m += offset * patchPixel.g;
    }

    // Compute angle = atan2(m01, m10)
    float angle = fastAtan2(m.y, m.x);

    // done!
    color.g = encodeOrientation(angle);
}